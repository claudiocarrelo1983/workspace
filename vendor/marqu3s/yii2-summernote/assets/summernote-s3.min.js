var summernoteS3uploader={signEndpoint:"",bucket:"",folder:"",filenamePrefix:"",maxFileSize:1024e3,expiration:"",file:"",editor:"",fileSlugify:function(s){return s=(s=s.replace(/[^\w\s-.]/g,"").trim().toLowerCase()).replace(/[-\s]+/g,"-")},getDateTimeString:function(){var date=new Date,y=date.getFullYear(),m=(m=date.getMonth()+1)<10?"0"+m:m,d=(d=date.getDate())<10?"0"+d:d,ho=(ho=date.getHours())<10?"0"+ho:ho,mi=(mi=date.getMinutes())<10?"0"+mi:mi,se=date.getSeconds();return y+m+d+ho+mi+(se=se<10?"0"+se:se)},getFolder:function(){return"string"==typeof this.folder?this.folder:this.folder()},getFilenamePrefix:function(){return"string"==typeof this.filenamePrefix?this.filenamePrefix:this.filenamePrefix()},sendImage:function(){var temp,filenamePrefix=this.getFilenamePrefix(),obj={key:this.getFolder()+filenamePrefix+this.fileSlugify(this.file.name),"Content-Type":this.file.type,success_action_status:"200","x-amz-storage-class":"REDUCED_REDUNDANCY",acl:"public-read",bucket:this.bucket},conditions=[],formData=new FormData;for(var key in obj)(temp={})[key]=obj[key],conditions.push(temp),formData.append(key,obj[key]);conditions.push(["content-length-range",0,this.maxFileSize]);var jsonPolicy,policy={};policy.expiration=this.expiration,policy.conditions=conditions,jsonPolicy=JSON.stringify(policy),$.ajax({url:this.signEndpoint,type:"POST",data:jsonPolicy,dataType:"json",contentType:"application/json; charset=UTF-8",processData:!1,success:function(response){0<response.policy.length&&0<response.signature.length&&(formData.delete("bucket"),formData.append("policy",response.policy),formData.append("x-amz-signature",response.signature),formData.append("x-amz-date",response.x_amz_date),formData.append("x-amz-credential",response.x_amz_credential),formData.append("x-amz-algorithm",response.x_amz_algorithm),formData.append("file",summernoteS3uploader.file),$.ajax({data:formData,dataType:"xml",type:"POST",cache:!1,contentType:!1,processData:!1,url:"https://"+summernoteS3uploader.bucket+".s3.amazonaws.com/",complete:function(data,textStatus){var url;"success"===textStatus&&(url="https://"+summernoteS3uploader.bucket+".s3.amazonaws.com/"+summernoteS3uploader.getFolder()+filenamePrefix+summernoteS3uploader.fileSlugify(summernoteS3uploader.file.name),setTimeout(function(){summernoteS3uploader.editor.summernote("insertImage",url)},1e3))}}))}})}};